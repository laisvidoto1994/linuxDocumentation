<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">

<html>

<head>

<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">

<title>Guia Foca GNU/Linux - Gerenciadores de Partida (boot loaders)</title>

</head>

<body>

<a name="ch-boot"></a>
<hr>

[ <a href="ch-disc.htm">anterior</a> ]
[ <a href="index.htm#contents">Conteúdo</a> ]
[ <a href="ch-intro.htm">1</a> ]
[ <a href="ch-bas.htm">2</a> ]
[ <a href="ch-hardw.htm">3</a> ]
[ <a href="ch-d-l.htm">4</a> ]
[ <a href="ch-disc.htm">5</a> ]
[ 6 ]
[ <a href="ch-run.htm">7</a> ]
[ <a href="ch-cmdd.htm">8</a> ]
[ <a href="ch-cmd.htm">9</a> ]
[ <a href="ch-cmdv.htm">10</a> ]
[ <a href="ch-cmdn.htm">11</a> ]
[ <a href="ch-cmdc.htm">12</a> ]
[ <a href="ch-perm.htm">13</a> ]
[ <a href="ch-redir.htm">14</a> ]
[ <a href="ch-rede.htm">15</a> ]
[ <a href="ch-kern.htm">16</a> ]
[ <a href="ch-log.htm">17</a> ]
[ <a href="ch-cpctd.htm">18</a> ]
[ <a href="ch-deb.htm">19</a> ]
[ <a href="ch-dpkg.htm">20</a> ]
[ <a href="ch-pers.htm">21</a> ]
[ <a href="ch-impr.htm">22</a> ]
[ <a href="ch-cfg.htm">23</a> ]
[ <a href="ch-tasks.htm">24</a> ]
[ <a href="ch-compil.htm">25</a> ]
[ <a href="ch-manut.htm">26</a> ]
[ <a href="ch-etc.htm">27</a> ]
[ <a href="ch-inter.htm">28</a> ]
[ <a href="ch-x11.htm">29</a> ]
[ <a href="ch-aplic.htm">30</a> ]
[ <a href="ch-ajuda.htm">31</a> ]
[ <a href="ch-apend.htm">32</a> ]
[ <a href="ch-run.htm">próximo</a> ]

<hr>

<h1>
Guia Foca GNU/Linux
<br>Capítulo 6 - Gerenciadores de Partida (boot loaders)
</h1>

<hr>

<p>
<em>Gerenciadores de Partida</em> são programas que carregam um sistema
operacional e/ou permitem escolher qual será iniciado.  Normalmente este
programas são gravados no <em>setor de boot</em> (inicialização) da partição
ativa ou no <em>master boot record</em> (MBR) do disco rígido.

<p>
Este capitulo explica o funcionamento de cada um dos principais gerenciadores
de partida usados no <code>GNU/Linux</code>, em que situações é recomendado seu
uso, as características, como configura-lo e alguns exemplos de configuração.

<hr>

<a name="s-boot-lilo"></a>
<h2>6.1 LILO</h2>

<p>
O <code>LILO</code> (<em>Linux Loader</em>) é sem dúvida o gerenciador de
partida padrão para quem deseja iniciar o <code>GNU/Linux</code> através do
disco rígido.  Ele permite selecionar qual sistema operacional será iniciado
(caso você possua mais de um) e funciona tanto em discos rígidos <em>IDE</em>
como <em>SCSI</em>.

<p>
A seleção de qual sistema operacional e a passagem de parâmetros ao kernel pode
ser feita automaticamente ou usando o aviso de <samp>boot:</samp> do
<code>LILO</code>.

<hr>

<a name="s-boot-lilo-cfg"></a>
<h3>6.1.1 Criando o arquivo de configuração do LILO</h3>

<p>
Os dados para a criação do novo <em>setor de boot</em> que armazenará o
gerenciador de partida são lidos do arquivo <code>/etc/lilo.conf</code> Este
arquivo pode ser criado em qualquer editor de textos (como o <code>ae</code> ou
<code>vi</code>).  Normalmente ele é criado durante a instalação de sua
distribuição <code>GNU/Linux</code> mas por algum motivo pode ser preciso
modifica-lo ou personaliza-lo (para incluir novos sistemas operacionais,
mensagens, alterar o tempo de espera para a partida automática, etc).

<p>
O arquivo <code>/etc/lilo.conf</code> é dividido em duas seções: <em>Geral</em>
e <em>Imagens</em>.  A seção <em>Geral</em> vem no inicio do arquivo e contém
opções que serão usadas na inicialização do <code>Lilo</code> e parâmetros que
serão passados ao kernel.  A seção <em>Imagens</em> contém opções especificas
identificando qual a partição que contém o sistema operacional, como será
montado inicialmente o sistema de arquivos, tabela de partição, o arquivo que
será carregado na memória para inicializar o sistema, etc.  Abaixo um modelo do
arquivo <code>/etc/lilo.conf</code> para sistemas que só possuem o
<code>GNU/Linux</code> instalado:

<pre>
     boot=/dev/hda1
     compact
     install=text
     map=/boot/map
     vga=normal
     delay=20
     lba32
     
     image=/vmlinuz
         root=/dev/hda1
         label=Linux
         read-only
</pre>

<p>
Para criar um novo gerenciador de partida através do arquivo
<code>/etc/lilo.conf</code> , execute o comando <samp>lilo</samp>.

<p>
No exemplo acima, o gerenciador de partida será instalado em
<code>/dev/hda1</code> (veja <a href="ch-disc.htm#s-disc-id">Identificação de
discos e partições em sistemas Linux, Seção 5.12</a>) , utilizará um setor de
boot compacto (compact), modo de vídeo VGA normal (80x25), esperará 2 segundos
antes de processar automaticamente a primeira seção <samp>image=</samp> e
carregará o kernel <code>/vmlinux</code> de <code>/dev/hda1</code>.  Para
detalhes sobre opções que podem ser usadas neste arquivo veja <a
href="#s-boot-lilo-opcoes">Opções usadas no LILO, Seção 6.1.2</a>.

<p>
Para mostrar o aviso de <samp>boot:</samp>, você deverá ligar as teclas Caps
Lock ou Scrool lock na partida ou pressionar a tecla <samp>Shift</samp> durante
os dois segundos de pausa.  Outro método é incluir a opção <samp>prompt</samp>
na seção <em>global</em> para que o aviso de <samp>boot:</samp> seja mostrado
automaticamente após carregar o <code>Lilo</code>.

<p>
Abaixo uma configuração para computadores com mais de um sistema operacional
(Usando <code>GNU/Linux</code> e <code>DOS</code>):

<pre>
     boot=/dev/hda1
     compact
     lba32
     install=menu
     map=/boot/map
     vga=normal
     delay=20
     prompt
     
     image=/vmlinuz
         root=/dev/hda1
         label=linux
         read-only
     
     other=/dev/hda2
      table=/dev/hda
      label=dos
</pre>

<p>
O exemplo acima é idêntico ao anterior, o que foi acrescentado foi a opção
<samp>prompt</samp> na seção <em>geral</em> (para que seja mostrado
imediatamente o aviso de <samp>boot:</samp> no momento em que o
<code>LILO</code> for carregado), e incluída uma imagem de disco
<code>DOS</code> localizado em <code>/dev/hda2</code>.  No momento da
inicialização é mostrada a mensagem <samp>boot:</samp> e caso seja digitado
<samp>DOS</samp> e pressionado ENTER, o sistema iniciará o <code>DOS</code>.
Caso a tecla Enter seja pressionada sem especificar a imagem, a primeira será
carregada (neste caso o <code>GNU/Linux</code>).

<p>
Você pode substituir a palavra <samp>GNU/Linux</samp> da opção
<samp>label</samp> por o número <samp>1</samp> e <samp>DOS</samp> por
<samp>2</samp>, desta forma o número pode ser digitado para iniciar o sistema
operacional.  Isto é muito útil para construir um menu usando a opção
<samp>message</samp>.  Para detalhes veja <a href="#s-boot-lilo-opcoes">Opções
usadas no LILO, Seção 6.1.2</a>.

<p>
A seção <em>Geral</em> vem do inicio do arquivo até a palavra
<samp>delay=20</samp>.  A partir do primeiro aparecimento da palavra
<samp>image</samp>, <samp>other</samp> ou <samp>range</samp>, tudo o que vier
abaixo será interpretado como imagens de inicialização.

<p>
Por padrão, a imagem carregada é a especificada por <samp>default=</samp> ou a
primeira que aparece no arquivo (caso <samp>default=</samp> não seja
especificado).  Para carregar o outro sistema (o <code>DOS</code>), digite o
nome da imagem de disco no aviso de <samp>boot:</samp> (especificada em
<samp>label=</samp>) que será carregada.  Você também pode passar parâmetros
manualmente ao kernel digitando o nome da imagem de disco e uma opção do kernel
ou através do arquivo <code>/etc/lilo.conf</code> (veja <a
href="#s-boot-lilo-opcoes">Opções usadas no LILO, Seção 6.1.2</a>).

<p>
O <code>LILO</code> pode inicializar o seguintes tipos de imagens:
<ul>
<li>
Imagens do kernel de um arquivo.  Normalmente usado para iniciar o
<code>GNU/Linux</code> pelo disco rígido e especificado pelo parâmetro
<samp>image=</samp>.
</li>
<li>
Imagens do kernel de um dispositivo de bloco (como um disquete).  Neste caso o
número de setores a serem lidos devem ser especificados na forma
<em>PRIMEIRO-ÚLTIMO</em> ou <em>PRIMEIRO+NÚMERO de setores a serem lidos</em>.
<p>
É necessário especificar o parâmetro <samp>image=</samp> e <samp>range=</samp>,
por exemplo:
<pre>
     image=/dev/fd0
        range=1+512
</pre>
<p>
Todas as opções do kernel podem ser usadas na inicialização por dispositivo.
</li>
<li>
O setor de boot de outro sistema operacional (como o <code>DOS</code>,
<code>OS/2</code>, etc).  O setor de partida é armazenado junto com a tabela de
partição no arquivo <code>/boot/map</code>.  É necessário especificar o
parâmetro <samp>OTHER=dispositivo</samp> ou <samp>OTHER=arquivo</samp> e a
inicialização através de um setor de partida possui algumas opções especiais
como o <samp>TABLE=</samp> (para especificar a tabela de partição) e o
<samp>MAP-DRIVE=</samp> (identificação da unidade de discos pelo sistema
operacional).  Veja o exemplo desta configuração abaixo:
<pre>
     other=/dev/hda2
       table=/dev/hda
       label=DOS
       map-drive=0x80
        to = 0x81
       map-drive=0x81
        to = 0x80
</pre>
</li>
</ul>

<p>
Observações:
<ul>
<li>
Caso o gerenciador de partida seja instalado no MBR do disco rígido
(boot=/dev/hda), o setor de boot do antigo sistema operacional será
substituído, retire uma cópia do setor de boot para um disquete usando o
comando <samp>dd if=/dev/hda of=/floppy/mbr bs=512 count=1</samp> no
<code>GNU/Linux</code> para salvar o setor de boot em um disquete e <samp>dd
if=/floppy/mbr of=/dev/hda bs=446 count=1</samp> para restaura-lo.  No
<code>DOS</code> você pode usar o comando <code>fdisk /mbr</code> para criar um
novo Master Boot Record.
</li>
<li>
Após qualquer modificação no arquivo <code>/etc/lilo.conf</code> , o comando
<samp>lilo</samp> deverá ser novamente executado para atualizar o setor de
partida do disco rígido.  Isto também é válido caso o kernel seja atualizado ou
a partição que contém a imagem do kernel desfragmentada.
</li>
<li>
A limitação de 1024 cilindros do <code>Lilo</code> não existe mais a partir da
versão 21.4.3 (recomendada, por conter muitas correções) e superiores.
</li>
<li>
A reinstalação, formatação de sistemas <code>DOS</code> e <code>Windows</code>
pode substituir o setor de partida do HD e assim o gerenciador de partida,
tornando impossível a inicialização do <code>GNU/Linux</code>.  Antes de
reinstalar o <code>DOS</code> ou <code>Windows</code>, verifique se possui um
disquete de partida do <code>GNU/Linux</code>.
<p>
Para gerar um novo boot loader, coloque o disquete na unidade e após o aviso
<samp>boot:</samp> ser mostrado, digite <samp>linux root=/dev/hda1</samp> (no
lugar de <code>/dev/hda1</code> você coloca a partição raiz do
<code>GNU/Linux</code>), o sistema iniciará.  Dentro do <code>GNU/Linux</code>,
digite o comando <code>lilo</code> para gerar um novo setor de partida.
<p>
Agora reinicie o computador, tudo voltará ao normal.
</li>
</ul>

<hr>

<a name="s-boot-lilo-opcoes"></a>
<h3>6.1.2 Opções usadas no LILO</h3>

<p>
Esta seção traz opções úteis usadas no arquivo <code>lilo.conf</code> com
explicações sobre o que cada uma faz.  As opções estão divididas em duas
partes: As usadas na seção <em>Global</em> e as da seção <em>Imagens</em> do
arquivo <code>lilo.conf</code>.

<p>
<samp>Global</samp>
<ul>
<li>
<samp>backup=[arquivo/dispositivo]</samp> - Copia o setor de partida original
para o arquivo ou dispositivo especificado.
</li>
</ul>
<ul>
<li>
<samp>boot=dispositivo</samp> - Define o nome do dispositivo onde será gravado
o setor de partida do <code>LILO</code> (normalmente é usada a partição ativa
ou o Master Boot Record - MBR).  Caso não seja especificado, o dispositivo
montado como a partição raiz será usado.
</li>
</ul>
<ul>
<li>
<samp>compact</samp> - Tenta agrupar requisições de leitura para setores
seguintes ao sendo lido.  Isto reduz o tempo de inicialização e deixa o mapa
menor.  É normalmente recomendado em disquetes.
</li>
</ul>
<ul>
<li>
<samp>default=imagem</samp> - Usa a imagem especificada como padrão ao invés da
primeira encontrada no arquivo <code>lilo.conf</code>.
</li>
</ul>
<ul>
<li>
<samp>delay=[num]</samp> - Permite ajustar o número de segundos (em décimos de
segundos) que o gerenciador de partida deve aguardar para carregar a primeira
imagem de disco (ou a especificada por <samp>default=</samp>).  Esta pausa lhe
permite selecionar que sistema operacional será carregado.
</li>
</ul>
<ul>
<li>
<samp>install=interface</samp> - Especifica que interface será usada para
exibição de menu com as opções de inicialização ao usuário.  As seguintes
opções são permitidas:
<ul>
<li>
<samp>text</samp> - Exibe uma mensagem de texto (exibida através do parâmetro
<em>message=</em>) na tela.  Esta é a recomendada para terminais.
</li>
<li>
<samp>menu</samp> - Exibe um menu que lhe permite selecionar através de uma
interface de menu a opção de inicialização.  Esta é a padrão.
</li>
<li>
<samp>bmp</samp> - Exibe um bitmap gráfico com a resolução de 640x480 com 16 ou
256 cores.
</li>
</ul>
</li>
</ul>
<ul>
<li>
<samp>lba32</samp> - Permite que o <code>LILO</code> quebre o limite de 1024
cilindros do disco rígido, inicializando o <code>GNU/Linux</code> em um
cilindro acima deste através do acesso .  Note que isto requer compatibilidade
com o BIOS, mais especificamente que tenha suporte a chamadas int 0x13 e
AH=0x42.  É recomendado o seu uso.
</li>
</ul>
<ul>
<li>
<samp>map=arquivo-mapa</samp> - Especifica a localização do arquivo de mapa
(<code>.map</code>).  Se não for especificado, <code>/boot/map</code> é usado.
</li>
</ul>
<ul>
<li>
<samp>message=arquivo</samp> - Especifica um arquivo que contém uma mensagem
que será mostrada antes do aviso de <samp>boot:</samp>.  Nenhuma mensagem é
mostrada até que seja pressionada a tecla <samp>Shift</samp> após mostrar a
palavra <samp>LILO</samp>.  O tamanho da mensagem deve ser no máximo 65535
bytes.  O arquivo de mapa deve ser novamente criado caso a mensagem seja
retirada ou modificada.  Na mensagem, o caracter <samp>FF</samp> (CTRL+L) limpa
a tela.
</li>
</ul>
<ul>
<li>
<samp>nowarn</samp> - Não mostra mensagens de alerta.
</li>
</ul>
<ul>
<li>
<samp>password=senha</samp> - Permite proteger todas as imagens de disco com
uma única senha.  Caso a senha esteja incorreta, o LILO é novamente carregado.
</li>
</ul>
<ul>
<li>
<samp>prompt</samp> - Mostra imediatamente o aviso de <samp>boot:</samp> ao
invés de mostrar somente quando a tecla <samp>Shift</samp> é pressionada.
</li>
</ul>
<ul>
<li>
<samp>verbose=[num]</samp> - Ativa mensagens sobre o processamento do
<code>LILO</code>.  Os números podem ser especificados de 1 a 5, quanto maior o
número, maior a quantidade de detalhes mostrados.
</li>
</ul>
<ul>
<li>
<samp>timeout=[num]</samp> - Ajusta o tempo máximo de espera (em décimos de
segundos) de digitação no teclado.  Se nenhuma tecla é pressionada no tempo
especificado, a primeira imagem é automaticamente carregada.  Igualmente a
digitação de senha é interrompida se o usuário estiver inativo por este
período.
</li>
</ul>

<p>
Adicionalmente as opções de imagem do kernel <samp>append, ramdisk, read-only,
read-write, root e vga</samp> podem ser especificadas na seção <em>global</em>.
<samp>Opções por Imagem</samp>

<p>
As opções por imagem iniciam com uma das seguintes opções: <samp>image=</samp>,
<samp>other=</samp> ou <samp>range=</samp>.  Opções usadas por cada imagem:
<ul>
<li>
<samp>table=dispositivo</samp> - Indica o dispositivo que contém a tabela de
partição para aquele dispositivo.  Necessário apenas para imagens especificadas
por <samp>other=</samp>.
</li>
</ul>
<ul>
<li>
<samp>unsafe</samp> - Não acessa o setor de boot no momento da criação do mapa.
Isto desativa algumas checagens, como a checagem da tabela de partição.
<samp>unsafe</samp> e <samp>table=</samp> são incompatíveis.
</li>
</ul>
<ul>
<li>
<samp>label=[nome]</samp> - Permite especificar um nome para a imagem.  Este
nome será usado na linha <samp>boot:</samp> para inicializar o sistema.
</li>
</ul>
<ul>
<li>
<samp>alias=[nome]</samp> - Apelido para a imagem de disco.  É como um segundo
<samp>label</samp>.
</li>
</ul>
<ul>
<li>
<samp>optional</samp> - Ignora a imagem caso não estiver disponível no momento
da criação do mapa.  É útil para especificar kernels que não estão sempre
presentes no sistema.
</li>
</ul>
<ul>
<li>
<samp>password=senha</samp> - Protege a imagem atual com a senha.  Caso a senha
esteja incorreta, o setor de partida do <code>Lilo</code> é novamente
carregado.
</li>
</ul>
<ul>
<li>
<samp>restricted</samp> - A senha somente é pedida para iniciar a imagem se o
sistema for iniciado no modo single.
</li>
</ul>

<p>
Também podem ser usados parâmetros de inicialização do kernel no arquivo
<code>/etc/lilo.conf</code>, veja a seção <a
href="#s-boot-kernelparam">Parâmetros de inicialização passados ao kernel,
Seção 6.3</a> para maiores detalhes.

<hr>

<a name="s-boot-lilo-exemplo"></a>
<h3>6.1.3 Um exemplo do arquivo de configuração lilo.conf</h3>

<p>
Abaixo um exemplo do arquivo <code>/etc/lilo.conf</code> que poderá ser usado
em instalações <code>GNU/Linux</code> com o <code>DOS</code>.

<pre>
     boot=/dev/hda1        #Instala o LILO em /dev/hda1
     compact               
     install=menu
     map=/boot/map
     message=/etc/lilo.message  #mensagem que será mostrada na tela
     default=1          #Carrega a Imagem especificada por label=1 como padrão
     vga=normal         #usa o modo de video 80x25 ao iniciar o Linux
     delay=20           #aguarda 2 segundos antes de iniciar a imagem padrão 
     lba32              #permite quebrar o limite de 1024 cilindros na inicialização
     prompt             #mostra o aviso de &quot;boot:&quot; logo que o LILO é carregado
     
     image=/vmlinuz     #especifica o arquivo que contém a primeira imagem
       root=/dev/hda1   #partição onde a imagem acima esta localizada
       label=1          #identificação da imagem de disco
       read-only        #monta inicialmente como somente leitura
       password=12345   #Usa a senha 12345
       restricted       #somente quando iniciar com o parâmetro single
     
     other=/dev/hda2    #especifica outro sistema que será carregado
      table=/dev/hda    #a tabela de partição dele está em /dev/hda
      label=2           #identificação desta imagem de disco
      password=12345    #pede a senha antes de iniciar este sistema
</pre>

<p>
Você pode usar o exemplo acima como base para construir sua própria
configuração personalizada do <code>/etc/lilo.conf</code> mas não se esqueça de
modificar as tabelas de partições para seu sistema.  Se você usa o
<code>Windows NT 4.0</code>, <code>Windows NT 5.0 (Windows 2000)</code> ou o
<code>OS/2</code>, recomendo ler o <samp>DOS+Windows+OS/2-HOWTO</samp>.

<p>
Após criar seu arquivo <code>/etc/lilo.conf</code> , execute o comando
<samp>lilo</samp> e se tudo ocorrer bem, o <code>LILO</code> será instalado.

<hr>

<a name="s-boot-grub"></a>
<h2>6.2 GRUB</h2>

<p>
(Os detalhes contidos na seção sobre o <code>GRUB</code>, foram integralmente
desenvolvidos por Alexandre Costa <code><a
href="mailto:alebyte@bol.com.br">alebyte@bol.com.br</a></code> como
contribuição ao guia FOCA GNU/Linux.)

<p>
O <code>GRUB</code> (<em>Grand Unified Boot Loader</em>) é mais uma alternativa
como gerenciador de boot e apresenta alguns recursos extras com relação as
outras opções disponíveis.  Ele é flexível, funcional e poderoso, podendo
inicializar sistemas operacionais como o <code>Windows</code> (9x, ME, NT, 2000
e XP), <code>Dos</code>, <code>Linux</code>, <code>GNU Hurd</code>,
<code>*BSD</code>, <code>OS/2</code> e etc.  Podemos destacar também o suporte
aos sistemas de arquivos ext2 (Linux), ext3 e reiserfs (novos sistemas de
arquivos journaling do Linux), FAT16 e FAT32 (Win 9x/ME), FFS (Fast File System
usado no *BSD), minix (MINIX OS) e etc.

<p>
Por utilizar o padrão Multiboot ele é capaz de carregar diversas imagens de
boot e módulos.  Por esse motivo ele é o único gerenciador de inicialização
capaz de carregar o conjunto de servidores do GNU Hurd.  O GRUB também permite
buscar imagens do kernel pela rede, por cabo seriais, suporta discos rígidos
IDE e SCSI, detecta toda a memória RAM disponível no sistema, tem interface
voltada para linha de comandos ou menus de escolha, além de suportar sistemas
sem discos e terminais remotos.

<p>
Como possui inúmeros recursos, será apresentada sua utilização básica, ficando
como sugestão ao leitor procurar se aprofundar mais em suas possibilidades de
uso e configuração.

<hr>

<a name="s-boot-grub-part"></a>
<h3>6.2.1 Como o GRUB trabalha com discos e partições</h3>

<p>
O GRUB trabalha com uma notação diferente para apontar discos e partições sendo
necessário algumas explicações antes de prosseguir.  Veja a tabela comparativa:

<pre>
     No Linux                No GRUB
     
     /dev/hda                (hd0)
     /dev/hda1               (hd0,0)
     /dev/hda2               (hd0,1)
     
     /dev/hdb                (hd1)
     /dev/hdb1               (hd1,0)
     /dev/hdb2               (hd1,1)
     
     /dev/sda                (hd0)   # Disco SCSI ID 0
     /dev/sda1               (hd0,0) # Disco SCSI ID 0, partição 1
     /dev/sda2               (hd0,1) # Disco SCSI ID 0, partição 2
     
     /dev/sdb                (hd1)   # Disco SCSI ID 1
     /dev/sdb1               (hd1,0) # Disco SCSI ID 1, partição 1
     /dev/sdb2               (hd1,1) # Disco SCSI ID 1, partição 2
     
     /dev/fd0                (fd0)
</pre>

<p>
<strong>OBS:</strong> Os discos <em>IDE</em> e <em>SCSI</em> são referenciados
ambos como (<samp>hd?</samp>) pelo <code>GRUB</code>.  Não há distinção entre
os discos e de modo geral a identificação de unidades IDE é menor do que
qualquer tipo de drive SCSI, salvo se você alterar a seqüência de inicialização
(boot) na BIOS.

<p>
Para saber como o Linux trabalha com partições veja <a
href="ch-disc.htm#s-disc-id">Identificação de discos e partições em sistemas
Linux, Seção 5.12</a>.

<hr>

<a name="s-boot-grub-install"></a>
<h3>6.2.2 Instalando o GRUB</h3>

<p>
A instalação do <code>GRUB</code> ao contrário da instalação do
<code>LILO</code> (<a href="#s-boot-lilo">LILO, Seção 6.1</a>), só precisa ser
executada uma única vez.  Caso seja necessária alguma mudança como por exemplo
adicionar uma nova imagem, esta pode ser feita apenas editando o arquivo de
configuração <code>menu.lst</code>.

<hr>

<a name="s-boot-grub-install-mbr"></a>
<h4>6.2.2.1 No MBR</h4>

<p>
Um método simples de adicionar o <code>GRUB</code> para gerenciar seu MBR
(<em>Master Boot Record</em>) é rodando o seguinte comando (como superusuário):

<pre>
     # /sbin/grub-install /dev/hda
</pre>

<p>
Este comando grava o <code>GRUB</code> no MBR do primeiro disco e cria o
diretório <code>/boot/grub</code> onde estarão os arquivos necessários para o
seu funcionamento.  Neste ponto o <code>GRUB</code> já está instalado e quando
você reiniciar seu computador irá se deparar com uma linha de comandos, onde
terá que carregar a imagem do kernel manualmente.  Mais adiante será explorada
a utilização desta linha de comando que é muito eficiente.

<p>
Provavelmente você achará mais interessante copiar o arquivo de configuração de
exemplos do <code>GRUB</code> e otimizá-lo às suas necessidades.  Note que isto
não exclui a possibilidade de utilizar a linha de comando, apenas cria uma
interface de menus onde você pode configurar várias opções de boot de uma forma
organizada, automatizada e funcional.  Copie este arquivo para o diretório
<code>/boot/grub</code> com o seguinte comando:

<pre>
     # cp /usr/share/doc/grub/examples/menu.lst /boot/grub
</pre>

<p>
Por ser um arquivo de exemplos será necessário otimizá-lo de acordo com suas
necessidades, o que será abordado mais a frente.

<hr>

<a name="s-boot-grub-install-fd-cmd"></a>
<h3>6.2.3 No disco flexível (somente linha de comando)</h3>

<p>
Quando criamos um disquete de partida, este funcionará em um sistema qualquer,
podendo utilizar este disquete em várias máquinas diferentes ou em uma máquina
em que tenha tido algum problema com o <code>GRUB</code> no MBR.  Coloque um
disquete virgem e digite os seguintes comandos:

<pre>
     # dd if=/usr/lib/grub/i386-pc/stage1 of=/dev/fd0 count=1
     # dd if=/usr/lib/grub/i386-pc/stage2 of=/dev/fd0 seek=1
</pre>

<p>
Estes comandos permitem que seja apresentada a linha de comando do grub quando
este disco for utilizado para boot.

<hr>

<a name="s-boot-grub-install-fd-menu"></a>
<h3>6.2.4 No disco flexível (com interface de menu)</h3>

<p>
Quando foi criado o disquete de partida anteriormente, este só nos permitia
utilizar a linha de comando sendo necessário carregar o <code>menu.lst</code>
pelo disco rígido (o qual deve estar presente).  Em alguns casos este disco
satisfaz as necessidades básicas mas pode haver um momento em que você deseje
ter um disquete que funcione com vários sistema e não dependa de um disco fixo.

<p>
Digite os seguintes comandos:

<pre>
     # mke2fs /dev/fd0
     # mount /dev/fd0 /floppy -t ext2
     # mkdir /floppy/grub
     # cp /usr/lib/grub/i386-pc/stage[12] /floppy/grub
     # cp /usr/share/doc/grub/examples/menu.lst /floppy/grub
     # umount /floppy
     # /sbin/grub
</pre>

<p>
Este último comando disponibiliza a linha de comando do GRUB.  Digite os
seguintes comandos:

<pre>
     grub&gt; install (fd0)/grub/stage1 d (fd0) (fd0)/grub/stage2 p (fd0)/grub/menu.lst
     grub&gt; quit
</pre>

<p>
Neste momento o disquete está pronto.  Note que o <code>menu.lst</code> que foi
copiado para ele é um arquivo de exemplo, sendo necessário que você o configure
de acordo com suas necessidades.

<hr>

<a name="s-boot-grub-opcoescfg"></a>
<h3>6.2.5 Opções do arquivo de configuração</h3>

<p>
Esta seção descreve o arquivo <code>menu.lst</code> com explicações sobre as
opções mais usadas.  Este arquivo é dividido em parâmetros Globais, que afetam
o arquivo todo e parâmetros que só tem efeito para as imagens do sistema que
será carregado.  Algumas opções podem ser passadas para o kernel do Linux no
momento do boot, algumas delas também serão detalhadas.
<dl>
<dt>Parâmetros Globais</dt>
<dd>
<ul>
<li>
<samp>timeout</samp> = Define um tempo (em segundos) de espera.  Se nenhuma
tecla for pressionada, carrega a imagem padrão.
</li>
<li>
<samp>default</samp> = Define qual será a opção padrão que deve ser
automaticamente selecionada quando nenhuma outra for especificada em um tempo
definido por timeout.
</li>
<li>
<samp>fallback</samp> = Caso ocorra algum erro inesperado e a opção padrão não
possa ser carregada, este parâmetro define qual a outra opção deve ser
utilizada.
</li>
<li>
<samp>color</samp> = Permite que você escolha as cores usadas no menu de boot.
</li>
<li>
<samp>password</samp> = Permite que você especifique uma senha.  Está será
solicitada sempre que houver necessidade de realizar uma função que não seja
carregar as imagens disponíveis, como por exemplo acessar a linha de comandos
do GRUB.  Você pode utilizar também o parâmetro password para esconder um
arquivo que contenha outras configurações, como um menu.lst secreto.  O arquivo
pode ter um nome qualquer.
<pre>
     Ex.: password = senha (hd0,0)/boot/grub/secret.conf
</pre>
<p>
Você pode ter várias entradas do parâmetro &quot;password&quot; em um mesmo
arquivo sendo que uma delas é usada para bloquear o acesso as imagens/linha de
comandos e as outras usadas para carregar arquivos de opções do GRUB.  Quando
você digitar <samp>p</samp> para entrar com a senha, você pode digitar a senha
que protege as imagens/linha de comandos ou a que é utilizada para carregar os
arquivos de opções.
</li>
<li>
<samp>hiddenmenu</samp> = Está opção faz com que o menu de opções não seja
mostrado e de boot na imagem especificada por &quot;default&quot; depois de
expirado o tempo definido em <samp>timeout</samp>.  O usuário pode requisitar o
menu com as opções pressionando a tecla &lt;ESC&gt; antes que o tempo definido
em timeout expire.
</li>
</ul>
</dd>
</dl>
<dl>
<dt>Parâmetros que afetam apenas as imagens</dt>
<dd>
<ul>
<li>
<samp>title</samp> = Define um texto que será apresentado no menu de boot para
identificar o sistema a ser inicializado.
</li>
<li>
<samp>root</samp> = Determina qual a partição raiz do sistema a ser
inicializada.
</li>
<li>
<samp>rootnoverify</samp> = Idêntica a opção <samp>root</samp>, mas não tenta
montar a partição-alvo, o que é necessário para alguns sistemas como
<code>Dos</code> e <code>Windows</code>.
</li>
<li>
<samp>kernel</samp> = Nesta opção você informa qual o kernel vai ser
inicializado.  Você pode passar parâmetros diretamente para o kernel também.
<pre>
     Ex.: kernel (hd0,0)/boot/vmlinuz-2.4.16 vga=6
</pre>
</li>
<li>
<samp>module</samp> = Faz com que algum módulo necessário para o boot seja
carregado.  Lembre-se que estes não são módulos do kernel (módulos de som,
rede, etc.) e sim módulos necessários ao boot de alguns sistemas, como por
exemplo o <code>GNU Hurd</code>.
</li>
<li>
<samp>lock</samp> = Quando você quiser controlar se uma pessoa pode iniciar um
sistema que esteja listado nas opções do menu de boot, você pode utilizar esta
opção que faz com que a senha especificada com o comando &quot;password&quot;
seja solicitada no momento em que se tentar carregar a imagem em questão.
</li>
<li>
<samp>pause</samp> = Emite uma mensagem na tela e espera uma tecla ser
pressionada.
</li>
<li>
<samp>makeactive</samp> = Torna a partição ativa.  Este comando está limitado a
partições primárias dos discos.
</li>
<li>
<samp>chainloader</samp> = Alguns sistemas como o Windows ou Dos armazenam seu
próprio gerenciador de boot no início da partição em que ele está instalado.
Para efetuar o boot destes sistemas através do GRUB, você precisa pedir para
que o gerenciador de boot de tal sistema seja carregado e faça seu trabalho,
dando o boot.
</li>
<li>
<samp>hide</samp> e <samp>unhide</samp> = Esconde e mostra partição
respectivamente.  Estas duas opções são necessárias quando houver mais de uma
versão do Dos ou Windows na máquina em partições diferentes, já que estes
sistemas detectam automaticamente a partição e quase sempre o fazem de modo
errado.  Suponha o Windows na primeira partição primária (hd0,0) e o Dos na
segunda partição primária (hd0,1).  Quando quisermos carregar estes sistemas
devemos proceder da seguinte maneira:
<pre>
     title Windows
     hide (hd0,1)
     unhide (hd0,0)
     rootnoverify (hd0,0)
     chainloader  +1
     makeactive
     
     title Dos
     hide (hd0,0)
     unhide (hd0,1)
     rootnoverify (hd0,1)
     chainloader  +1
     makeactive
</pre>
</li>
<li>
<samp>map</samp> = Alguns sistemas não permitem ser inicializados quando não
estão no primeiro disco (Dos, Win 9x, etc.).  Para resolver esta e outras
situações o <code>GRUB</code> tem um comando que permite enganar tal sistema
mapeando as unidades de disco do modo como lhe for mais conveniente.
<p>
Imagine que você tenha o primeiro disco (hd0) com o GNU/Linux instalado e em um
outro disco (hd1) com o Windows/Dos instalado.  O Windows/Dos não permitem
serem inicializados desta forma e como solução você poderia usar a seguinte
entrada no arquivo de configurações do GRUB:
<pre>
     title Windows
     unhide (hd1,0)
     rootnoverify (hd1,0)
     chainloader +1
     map (hd1) (hd0)
     makeactive
</pre>
<p>
Isso faz com que o disco (hd1), onde esta o Windows/Dos, seja apresentado a
este sistema como (hd0) &quot;enganado&quot; o mesmo e possibilitando o boot.
</li>
</ul>
</dd>
</dl>
<dl>
<dt>Parâmetros enviados diretamente ao kernel</dt>
<dd>
Pode ser necessário passar alguns parâmetros para o kernel no momento do boot.
Para maiores informações ver a seção <a href="#s-boot-kernelparam">Parâmetros
de inicialização passados ao kernel, Seção 6.3</a>.  Você pode passar os
parâmetros da seguinte maneira:

<pre>
     # Exemplo de entrada no 'menu.lst'.
     title Linux 2.4.16
     root (hd0,0)
     kernel (hd0,0)/boot/vmlinuz-2.4.16 vga=6 mem=512M ramdisk=0
</pre>

<p>
Neste exemplo, a linha com o comando &quot;kernel&quot; é usada para indicar
qual imagem deve ser carregada.  As opções que seguem (vga, mem e ramdisk) são
parâmetros que devem ser passados diretamente ao kernel do sistema a ser
carregado.
</dd>
</dl>

<hr>

<a name="s-boot-grub-exemplo"></a>
<h3>6.2.6 Um exemplo de arquivo de configuração</h3>

<pre>
     # Exemplo de arquivo de configuração do GRUB.
     # Note que você pode usar o  caracter '#' para fazer comentários.
     
     # Se após 30 segundos nenhuma tecla for pressionada, carrega a imagem padrão.
     timeout 30
     
     # Define a primeira imagem como padrão.
     default 0
     
     # Caso a imagem padrão não funcione carrega a imagem definida aqui.
     fallback 1
     
     # Define as cores que serão usadas no menu.
     color light-cyan/black white/blue
     
     # Permite utilizar uma senha.
     password minha-senha-secreta
     password minha-senha (hd0,0)/boot/grub/secret.conf
     
     # Para boot com o GNU/Hurd
     title GNU/Hurd
     root (hd0,0)
     kernel /boot/gnumach.gz root=hd0s1
     module /boot/serverboot.gz
     
     # Para boot com o GNU/Linux
     title Linux 2.4.16
     # Pede a senha configurada em &quot;password&quot; antes de carregar esta imagem.
     lock
     root (hd0,0)
     # Atente as opções passadas diretamente para o kernel (vga, mem, etc.).
     kernel (hd0,0)/boot/vmlinuz-2.4.16 vga=6 mem=512M ramdisk=0
     
     # Para boot com o Mach (obtendo o kernel de um disquete)
     title Utah Mach4 multiboot
     root (hd0,2)
     pause Insira o disquete agora!!!
     kernel (fd0)/boot/kernel root=hd0s3
     module (fd0)/boot/bootstrap
     
     # Para boot com FreeBSD
     title FreeBSD 3.4
     root (hd0,2,a)
     kernel /boot/loader
     
     # Para boot com OS/2
     title OS/2
     root (hd0,1)
     makeactive
     chainloader +1
     chainloader /boot/chain.os2
     
     # Para boot com Windows 9x, ME, NT, 2000, XP.
     title Windows 9x, ME, NT, 2000, XP
     unhide (hd0,0)
     rootnoverify (hd0,0)
     chainloader  +1
     makeactive
     
     # Para instalar o GRUB no disco rígido.
     title = Instala o GRUB no disco rígido
     root = (hd0,0)
     setup = (hd0)
     
     # Muda as cores.
     title Mudar as cores
     color light-green/brown blink-red/blue
</pre>

<hr>

<a name="s-boot-grub-cmdline"></a>
<h3>6.2.7 Usando a linha de comandos do GRUB</h3>

<p>
O <code>GRUB</code> possui inúmeros recursos, mas com certeza um dos mais
importantes e que merece destaque é sua linha de comandos.  A maioria dos
comandos usados no arquivo de configuração <code>menu.lst</code> são válidos
aqui e muitos outros estão disponíveis.  Uma breve apresentação da linha de
comandos será dada, ficando por conta do leitor se aprofundar o quanto achar
necessário em sua flexibilidade.

<p>
Quando o <code>GRUB</code> é inicializado você pode se deparar com sua linha de
comandos ou se possuir o arquivo <code>menu.lst</code> configurado, um menu de
escolha.  Mesmo usando os menus de escolha você pode utilizar a linha de
comandos, bastando para isso seguir as instruções no rodapé da tela onde o
<code>GRUB</code> nos informa que podemos digitar <samp>e</samp> para editar as
entradas de boot ou <samp>c</samp> para ter acesso a linha de comandos
(lembre-se que pressionar <samp>&lt;ESC&gt;</samp> faz com que você volte aos
menus de escolha).

<p>
Caso a opção <samp>password</samp> tenha sido especificada no arquivo
<code>menu.lst</code>, será necessário antes de acessar as outras opções (que
estarão desabilitadas) pressionar <samp>p</samp> e entrar com a senha correta.

<p>
Agora, com acesso a linha de comandos, você pode verificar os comandos
disponíveis pressionando duas vezes a tecla &lt;TAB&gt;.  Note que você também
pode utilizar esta tecla para completar nomes de comandos bem como parâmetros
de alguns comandos.

<p>
Alguns comandos disponíveis:
<ul>
<li>
<samp>cat</samp> = Este comando permite verificar o conteúdo de um arquivo
qualquer, o qual deve estar gravado em um dispositivo ligado a sua máquina.
Embora seja um recurso útil, nenhuma permissão de acesso é verificada e
qualquer pessoa que tenha acesso a linha de comandos do GRUB pode listar o
conteúdo de arquivos importantes.  Para contornar este problema o parâmetro
<samp>password</samp> é utilizado no arquivo <code>menu.lst</code> e faz com
que uma senha seja solicitada antes de liberar o acesso a linha de comandos.
Não esqueça que ainda é possível utilizar um disquete com o <code>GRUB</code>
para dar boot na máquina o que permite usar a linha de comandos pelo disquete.
<pre>
     Ex.: grub&gt; cat (hd0,0)/etc/passwd
</pre>
</li>
<li>
<samp>cmp</samp> = Este comando é utilizado para comparar dois arquivos.
<pre>
     Ex.: grub&gt; cmp (hd0,0)/arquivo1 (hd0,0)/arquivo2
</pre>
</li>
<li>
<samp>configfile</samp> = Carrega um arquivo de configuração do GRUB.
<pre>
     Ex.: grub&gt; configfile (hd0,0)/boot/grub/menu.lst
</pre>
</li>
<li>
<samp>displayapm</samp> = Mostra informações sobre APM.
</li>
<li>
<samp>displaymem</samp> = Mostra informações sobre a memória RAM.
</li>
<li>
<samp>find</samp> = Permite encontrar um arquivo.  A saída deste comando
disponibiliza o nome completo do caminho para o arquivo e a partição onde o
mesmo está localizado.
<pre>
     Ex.: grub&gt; find stage1
</pre>
</li>
<li>
<samp>geometry</samp> = Mostra informações sobre a geometria reconhecida de seu
drive e permite que você escolha a geometria desejada caso esta esteja sendo
reconhecida erroneamente.
</li>
<li>
<samp>help</samp> = help &quot;comando&quot; para ver a ajuda.
<pre>
     Ex.: help color
</pre>
</li>
<li>
<samp>install</samp> = Instala o GRUB, embora não seja recomendado o uso deste
comando diretamente, pois é possível esquecer ou trocar facilmente um parâmetro
e sobrescrever a tabela de partições de seu disco.
<pre>
     Ex.: install (fd0)/grub/stage1 d (fd0) (fd0)/grub/stage2 p (fd0)/grub/menu.lst
</pre>
</li>
<li>
<samp>setup</samp> = Você pode usar este comando para instalar o GRUB.  Note
que sua sintaxe é menos complexa do que a usada em <samp>install</samp>.
<pre>
     Ex.: 
     grub&gt; root = (hd0,0)
     grub&gt; setup = (hd0)
</pre>
</li>
<li>
<samp>quit</samp> = Abandona a linha de comandos do GRUB.
</li>
<li>
<samp>reboot</samp> = Reinicia o computador.
</li>
<li>
<samp>boot</samp> = Efetua o boot.  Suponha o Linux instalado em (hd0,0),
podemos passar os seguintes comandos na linha de comandos para efetuar o boot
de uma imagem do GNU/Linux:
<pre>
     grub&gt; root (hd0,0)
     grub&gt; kernel (hd0,0)/boot/vmlinuz-2.4.16 vga=6
     grub&gt; boot
</pre>
</li>
</ul>

<p>
Muitos outros comandos estão disponíveis tanto na linha de comandos do
<code>GRUB</code> quanto no arquivo de configuração <code>menu.lst</code>.
Estes comandos adicionais podem ser necessários apenas para algumas pessoas e
por isso não serão explicados.

<hr>

<a name="s-boot-grub-removendo"></a>
<h3>6.2.8 Removendo o GRUB do MBR</h3>

<p>
Não existe a necessidade de se remover o <code>GRUB</code> do MBR pois não há
utilização para o mesmo vazio.  Para substituir o <code>GRUB</code> do MBR é
necessário apenas que outro gerenciador de boot escreva algo nele.  Você pode
seguir o procedimento de instalação do <code>LILO</code> para escrever algo no
MBR ou usar o comando <samp>fdisk /mbr</samp> do DOS.

<hr>

<a name="s-boot-grub-detalhes"></a>
<h3>6.2.9 Como obter informações mais detalhadas</h3>

<p>
Para obter informações mais detalhadas sobre o <code>GRUB</code> é recomendado
o site oficial do mesmo, o qual está disponível apenas na língua inglesa.  Os
seguintes sites foram utilizados na pesquisa:
<ul>
<li>
Site oficial do GRUB: <code><a
href="http://www.gnu.org/software/grub/">http://www.gnu.org/software/grub/</a></code>
</li>
<li>
Site Debian-br (<code><a
href="http://debian-br.cipsga.org.br/">http://debian-br.cipsga.org.br/</a></code>),
na parte de suporte, documentação, &quot;Como usar o GRUB: Um guia rápido para
usar o GRUB, feito por Vitor Silva Souza e Gustavo Noronha Silva&quot;.
</li>
</ul>

<hr>

<a name="s-boot-kernelparam"></a>
<h2>6.3 Parâmetros de inicialização passados ao kernel</h2>

<p>
Abaixo algumas das opções mais usadas para passar parâmetros de inicialização
de hardware/características ao kernel.
<ul>
<li>
<samp>append=string</samp> - Passa os parâmetros especificados ao kernel.  É
extremamente útil para passar parâmetros de hardwares que podem ter problemas
na hora da detecção ou para parâmetros que precisam ser passados constantemente
ao kernel através do aviso <samp>boot:</samp>.

<p>
Exemplo: <samp>append=&quot;mem=32m&quot;</samp>
</li>
</ul>
<ul>
<li>
<samp>ramdisk=tamanho</samp> - Especifica o tamanho do disco RAM que será
criado.  Caso for igual a zero, nenhum disco RAM será criado.  Se não for
especificado, o tamanho do disco RAM usado na imagem de inicialização do kernel
será usada.
</li>
</ul>
<ul>
<li>
<samp>read-only</samp> - Especifica que o sistema de arquivos raiz deverá ser
montado como somente leitura.  Normalmente o sistema de inicialização remonta o
sistema de arquivos como leitura/gravação.
</li>
</ul>
<ul>
<li>
<samp>read-write</samp> - Especifica que o sistema de arquivos raiz deverá ser
montado como leitura e gravação.
</li>
</ul>
<ul>
<li>
<samp>root=dispositivo</samp> - Especifica o dispositivo que será montado como
raiz.  Se a palavra <samp>current</samp> é usada, o dispositivo atual será
montado como raiz.
</li>
</ul>
<ul>
<li>
<samp>vga=modo</samp> - Especifica o mode de video texto que será usado durante
a inicialização.
<ul>
<li>
<samp>normal</samp> - Usa o modo 80x25 (80 colunas por 25 linhas)
</li>
<li>
<samp>extended</samp> (ou ext) - Usa o modo de texto 80x50
</li>
<li>
<samp>ask</samp> - Pergunta que modo de video usar na inicialização.  Os modos
de vídeo podem ser obtidos pressionando-se enter quando o sistema perguntar o
modo de vídeo.
</li>
</ul>
</li>
</ul>

<p>
Uma lista mais detalhada de parâmetros de inicialização pode ser obtida no
documento <samp>Boot-prompt-howto</samp> (veja <a
href="ch-ajuda.htm#s-ajuda-howto">Documentos HOWTO's, Seção 31.8</a>).

<hr>

<a name="s-boot-loadlin"></a>
<h2>6.4 LOADLIN</h2>

<p>
É um gerenciador de partida que permite iniciar o <code>GNU/Linux</code> a
partir do <code>DOS</code>.  A vantagem do uso do <code>Loadlin</code> é não
ser preciso reiniciar o computador para se entrar no <code>GNU/Linux</code>.
Ele funciona carregando o <code>kernel</code> (copiado para a partição
<code>DOS</code>) para a memória e inicializando o <code>GNU/Linux</code>.

<p>
Outro motivo pelo qual é muito usado é quando o <code>GNU/Linux</code> não tem
suporte a um certo tipo de dispositivo, mas este tem seu suporte no
<code>DOS</code> ou <code>Windows</code> e funciona corretamente com eles.

<p>
O truque é o seguinte: Você inicia normalmente pelo <code>DOS</code> e após seu
dispositivo ser configurado corretamente pelo driver do <code>DOS</code> e
funcionando corretamente, você executa o <code>Loadlin</code> e o
<code>GNU/Linux</code> assim poderá usa-lo.  Muitos usam o comando
<code>Loadlin</code> dentro do arquivo <code>autoexec.bat</code> para iniciar o
<code>GNU/Linux</code> automaticamente após o dispositivo ser configurado pelo
<code>DOS</code>.

<p>
ATENÇÃO!!!  Não execute o <code>Loadlin</code> dentro do Windows.

<hr>

<a name="s-boot-loadlin-opcoes"></a>
<h3>6.4.1 Opções do LOADLIN</h3>

<p>
Abaixo a lista de opções que podem ser usadas com o programa
<code>LOADLIN</code> (note que todas são usadas no <code>DOS</code>):

<p>
<samp>loadlin [<em>imagem_kernel</em>] [<em>argumentos</em>]
[<em>opções</em>]</samp>

<ul>
<li>
<samp>imagem_kernel</samp> - Arquivo que contém o kernel.
</li>
<li>
<samp>root=dispositivo</samp> - Especifica o dispositivo que contém o sistema
de arquivos raiz.  É especificado de acordo com a identificação de dispositivos
no <code>GNU/Linux</code> (<code>/dev/hda1</code>, <code>/dev/hdb1</code>,
etc).
</li>
<li>
<samp>ro</samp> - Diz ao kernel para montar inicialmente o sistema de arquivos
raiz como somente leitura.  Os scripts de inicialização normalmente modificam o
sistema de arquivos para leitura e gravação após sua checagem.
</li>
<li>
<samp>rw</samp> - Diz ao kernel para montar inicialmente o sistema de arquivos
raiz como leitura e gravação.
</li>
<li>
<samp>initrd=[NUM]</samp> - Define o tamanho do disco RAM usado no sistema.
</li>
<li>
<samp>-v</samp> - Mostra detalhes sobre mensagens e configuração
</li>
<li>
<samp>-t</samp> - Modo de teste, tudo é feito menos a inicialização do
<code>GNU/Linux</code>.
</li>
<li>
<samp>-d arquivo</samp> - Mesma função de <samp>-t</samp>, mas envia a saída
para o arquivo
</li>
<li>
<samp>-txmode</samp> - Altera o modo de vídeo para 80x25 antes de inicializar o
kernel.
</li>
<li>
<samp>-dskreset</samp> - Após carregar a imagem do kernel, reseta todos os
discos rígidos antes de inicializar o <code>GNU/Linux</code>.
</li>
</ul>

<hr>

<a name="s-boot-loadlin-exemplo"></a>
<h3>6.4.2 Exemplo de inicialização com o LOADLIN</h3>

<p>
Abaixo você encontra um exemplo do comando <samp>loadlin</samp> que poderá ser
usado em sua instalação <code>GNU/Linux</code> (precisando apenas ajustar a
localização da partição raiz do <code>GNU/Linux</code> de acordo com seu
sistema).

<pre>
      C:\&gt; LOADLIN vmlinuz root=/dev/hda1 ro
                     |        |            |
                     |        |            +- Montar como somente leitura
                     |        |
                     |        +- Partição raiz
                     |
                     +- Nome do kernel copiado para o DOS
</pre>

<hr>

<a name="s-boot-syslinux"></a>
<h2>6.5 syslinux</h2>

<p>
Outro gerenciador de partida que funciona somente com sistemas de arquivos
<code>DOS</code>.  A principal diferença do <code>syslinux</code> em relação ao
<code>LOADLIN</code> é que foi feito especialmente para funcionar em disquetes
formatados no <code>DOS</code>, facilitando a instalação do
<code>GNU/Linux</code> e para a criação de disquetes de recuperação ou de
inicialização.  Um disquete gerado pelo <code>syslinux</code> é lido sem
problemas pelo <code>DOS</code>/<code>Windows</code>.

<p>
<samp>syslinux [-s] [<em>dispositivo</em>]</samp>

<p>
A opção <samp>-s</samp> instala no disquete uma versão segura, lenta e estúpida
do <code>syslinux</code>.  Isto é necessário para algumas <samp>BIOS</samp>
problemáticas.

<hr>

<a name="s-boot-syslinux-criando"></a>
<h3>6.5.1 Criando um disquete de inicialização com o syslinux</h3>

<p>
Siga os passos abaixo para criar um disquete de inicialização com o
<code>syslinux</code>:
<ol type="1" start="1" >
<li>
Formate o disquete no <code>DOS</code> ou com alguma ferramenta
<code>GNU/Linux</code> que faça a formatação de disquetes para serem usados no
<code>DOS</code>.
</li>
</ol>
<ol type="1" start="2" >
<li>
Copie um ou mais arquivos de <code>kernel</code> para o disquete
</li>
</ol>
<ol type="1" start="3" >
<li>
Digite <samp>syslinux /dev/fd0</samp> (lembre-se de usar a opção
<samp>-s</samp> se tiver problemas de inicialização).  Este comando modificará
o setor de partida do disquete e gravará um arquivo chamado
<code>LDLINUX.SYS</code> no diretório raiz do disquete.

<p>
Lembre-se: O disquete deve estar desmontado antes de usar o comando
<code>syslinux</code>, caso o disquete estiver montado uma mensagem será
mostrada e o <code>syslinux</code> abortado.
</li>
</ol>

<p>
Por padrão é carregado o kernel de nome <code>GNU/Linux</code>.  Este padrão
pode ser modificado através do arquivo de configuração
<code>SYSLINUX.CFG</code> que também é gravado no diretório raiz do disquete.
Veja <a href="#s-boot-syslinux-opcoes">O arquivo SYSLINUX.CFG, Seção 6.5.2</a>
para detalhes.

<p>
Se as teclas Caps Lock ou Scrool Lock estiverem ligadas ou Shift, Alt forem
pressionadas durante o carregamento do <code>syslinux</code>, o
<code>syslinux</code> mostrará um aviso de <samp>boot:</samp> no estilo do
<code>LILO</code>.  O usuário pode então digitar o nome do kernel seguido de
qualquer parâmetro para inicializar o <code>GNU/Linux</code>.

<hr>

<a name="s-boot-syslinux-opcoes"></a>
<h3>6.5.2 O arquivo SYSLINUX.CFG</h3>

<p>
Este arquivo é criado no diretório raiz da unidade de disquete e contém as
opções que serão usadas para modificar o funcionamento do
<code>syslinux</code>.  Abaixo a listagem de opções que podem ser especificadas
neste arquivo:
<dl>
<dt>default [kernel] [opções]</dt>
<dd>
Indica o nome do kernel e as opções dele que serão usadas na inicialização,
caso <code>syslinux</code> seja iniciado automaticamente.  Caso não for
especificada, o valor assumido será <em>linux auto</em> sem nenhuma opção de
inicialização.
</dd>
<dt>append [opções]</dt>
<dd>
Passa uma ou mais opções ao kernel na inicialização.  Elas serão adicionadas
automaticamente para inicializações automáticas e manuais do
<code>syslinux</code>.
</dd>
<dt>label [nome]</dt>
<dt>kernel [kernel]</dt>
<dt>append [opções]</dt>
<dd>
Nome que identificará o kernel no aviso de <samp>boot:</samp> (idêntica a opção
<samp>label=</samp> do <code>LILO</code>).  Se a imagem especificada por
<samp>nome</samp> for selecionada, o kernel usado será o especificado pelo
parâmetro <samp>kernel</samp> e as opções usadas por <samp>append</samp>.
<p>
Caso seja passado um hífen <samp>-</samp> ao parâmetro <samp>append</samp>, os
parâmetros passados pelo <samp>append</samp> global serão anulados.
</dd>
<dt>implicit [valor]</dt>
<dd>
Se o [valor] for igual a 0, não carrega a imagem até que seja explicitamente
especificada na opção <samp>label</samp>.
</dd>
<dt>timeout [tempo]</dt>
<dd>
Indica quanto tempo o <code>syslinux</code> aguardará antes de inicializar
automaticamente (medido em 1/10 de segundos).  Caso alguma tecla seja
pressionada, a inicialização automática é interrompida.  Para desativar esta
característica, use 0 como <samp>timeout</samp>.  O valor máximo é de 35996.
</dd>
<dt>font [nome]</dt>
<dd>
Especifica uma fonte (em formato <code>.psf</code>) que será usada para mostrar
as mensagens do <code>syslinux</code> (após o aviso de copyright do programa).
Ele carrega a fonte para a placa de vídeo, se a fonte conter uma tabela
unicode, ela será ignorada.  Somente funciona em placas EGA e VGA.
</dd>
<dt>kbdmap [mapa]</dt>
<dd>
Instala um simples mapa de teclado.  O mapa de teclados usado é muito simples:
somente remapeia códigos conhecidos pela <code>BIOS</code>, o que significa que
somente teclas usadas no teclado padrão EUA serão usadas.
<p>
O utilitário <code>keytab-lilo.pl</code> da distribuição do <code>lilo</code>
pode ser usado para criar tais mapas de teclado.
</dd>
<dt>prompt [valor]</dt>
<dd>
Se [valor] for igual a 1, mostra automaticamente o aviso de <samp>boot:</samp>
assim que o <code>syslinux</code> for iniciado.  Caso seja igual a 0, mostra o
aviso de <samp>boot:</samp> somente se as teclas Shift ou Alt forem
pressionadas ou Caps Lock e Scrool Lock estiverem ativadas.
</dd>
<dt>display [arquivo]</dt>
<dd>
Mostra o conteúdo do [arquivo] durante a inicialização do
<code>syslinux</code>.
</dd>
<dt>F1 [arquivo]</dt>
<dt>F2 [arquivo]</dt>
<dt>...</dt>
<dt>F0 [arquivo]</dt>
<dd>
Especifica que arquivos serão mostrados quando as teclas de F1 até F10 forem
pressionadas.  Para detalhes, veja <a
href="#s-boot-syslinux-formatacao">Formatação dos arquivos de tela do syslinux,
Seção 6.5.3</a>.
</dd>
</dl>

<hr>

<a name="s-boot-syslinux-formatacao"></a>
<h3>6.5.3 Formatação dos arquivos de tela do syslinux</h3>

<p>
Os arquivos de texto que são mostrados na tela pelo <code>syslinux</code> podem
ter suas cores modificadas usando parâmetros simples, isto causa um bom efeito
de apresentação.  Abaixo estão os códigos que podem ser usados para criar um
arquivo texto que será exibido pelo <code>syslinux</code>:

<pre>
     CTRL+L - Limpa a tela (semelhante ao que o clear faz). 
     CTRL+O[frente][fundo] - Define a cor de frente e fundo, se somente 
                      uma cor for especificada, esta será assumida como frente. 
                      Veja os valores para [frente] e [fundo] abaixo:
                      00 - preto                      08 - cinza escuro
                      01 - azul escuro                09 - azul claro
                      02 - verde escuro               0a - verde claro 
                      03 - ciano escuro               0b - ciano claro
                      04 - vermelho escuro            0c - vermelho claro 
                      05 - purple escuro              0d - purple claro
                      06 - marrom                     0e - amarelo 
                      07 - cinza claro                0f - branco
     CTRL+Z       - Equivalente ao fim de arquivo no DOS
</pre>

<p>
O código padrão usado é o 07.  Escolhendo uma cor clara para o fundo (08-0f)
resultará em uma cor piscante correspondente para a texto (00-07).

<hr>

[ <a href="ch-disc.htm">anterior</a> ]
[ <a href="index.htm#contents">Conteúdo</a> ]
[ <a href="ch-intro.htm">1</a> ]
[ <a href="ch-bas.htm">2</a> ]
[ <a href="ch-hardw.htm">3</a> ]
[ <a href="ch-d-l.htm">4</a> ]
[ <a href="ch-disc.htm">5</a> ]
[ 6 ]
[ <a href="ch-run.htm">7</a> ]
[ <a href="ch-cmdd.htm">8</a> ]
[ <a href="ch-cmd.htm">9</a> ]
[ <a href="ch-cmdv.htm">10</a> ]
[ <a href="ch-cmdn.htm">11</a> ]
[ <a href="ch-cmdc.htm">12</a> ]
[ <a href="ch-perm.htm">13</a> ]
[ <a href="ch-redir.htm">14</a> ]
[ <a href="ch-rede.htm">15</a> ]
[ <a href="ch-kern.htm">16</a> ]
[ <a href="ch-log.htm">17</a> ]
[ <a href="ch-cpctd.htm">18</a> ]
[ <a href="ch-deb.htm">19</a> ]
[ <a href="ch-dpkg.htm">20</a> ]
[ <a href="ch-pers.htm">21</a> ]
[ <a href="ch-impr.htm">22</a> ]
[ <a href="ch-cfg.htm">23</a> ]
[ <a href="ch-tasks.htm">24</a> ]
[ <a href="ch-compil.htm">25</a> ]
[ <a href="ch-manut.htm">26</a> ]
[ <a href="ch-etc.htm">27</a> ]
[ <a href="ch-inter.htm">28</a> ]
[ <a href="ch-x11.htm">29</a> ]
[ <a href="ch-aplic.htm">30</a> ]
[ <a href="ch-ajuda.htm">31</a> ]
[ <a href="ch-apend.htm">32</a> ]
[ <a href="ch-run.htm">próximo</a> ]

<hr>

<p>
Guia Foca GNU/Linux

<address>
Versão 5.45 - segunda, 30 de outubro de 2006<br>
<br>
Gleydson Mazioli da Silva <code><a href="mailto:gleydson@guiafoca.org">gleydson@guiafoca.org</a></code><br>
<br>
</address>

<hr>

</body>

</html>

